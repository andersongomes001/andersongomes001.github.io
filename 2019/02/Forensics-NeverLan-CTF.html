<html lang="pt-BR">
<head>
  <title>NeverLan CTF - Forensics - Anderson Gomes</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" type="text/css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="/assets/css/main.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
  <script src="/assets/js/shuffle-text.js"></script>
</head>

<body>
  <div class="fixed-top">
    <nav class="navbar navbar-expand-lg d-none d-lg-block d-xl-block nav1" style="height:40px;border-bottom: #7e099f !important; background: #FFFFFF;">
      <div class="container">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="#">
              <i class="fa fa-facebook-official fa-2x font_color_primary"></i>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <i class="fa fa-linkedin fa-2x font_color_primary"></i>
            </a>
          </li>
        </ul>
      </div>
    </nav>
    <nav class="navbar navbar-expand-lg navbar-light background_color_primary nav2">
      <div class="container">
        <a class="navbar-brand suffletext" data-text="Anderson Gomes" href="/">Anderson Gomes</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item">
              <a class="nav-link suffletext" data-text="Writeups" href="/writeups">Writeups</a>
            </li>
            <!--li class="nav-item dropdown">
              <a data-text="Guia de Estudos" class="nav-link dropdown-toggle suffletext" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Guia de Estudos
              </a>
              <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                <a data-text="Forense" class="dropdown-item suffletext" href="forense">Forense</a>
                <a data-text="Criptografia" class="dropdown-item suffletext" href="criptografia">Criptografia</a>
                <a data-text="Exploração na Web" class="dropdown-item suffletext" href="web">Exploração na Web</a>
                <a data-text="Engenharia reversa" class="dropdown-item suffletext" href="eng-reversa">Engenharia reversa</a>
                <a data-text="Exploração Binária" class="dropdown-item suffletext" href="exp-binaria">Exploração Binária</a>
              </div>
            </li-->
          </ul>
        </div>
      </div>
    </nav>
  </div>
  <div class="container-fluid" style="margin-top:100px;min-height: 700px;">
      <div class="container" id="content">
          <div class="posts">
        <h1>NeverLan CTF - Forensics</h1>
        <hr />
<p><a href="#title-return-of-the-sith---part-1">Return of the Sith - Part 1</a> - <a href="#title-return-of-the-sith---part-2">Return of the Sith - Part 2</a> - <a href="#title-return-of-the-sith---part-3">Return of the Sith - Part 3</a></p>

<hr />

<h2 id="title-return-of-the-sith---part-1">Title: Return of the Sith - Part 1</h2>

<h3 id="points-100">Points: 100</h3>

<p>We’ve been given a specific forensics case by a really grumpy customer. He starting smashing consoles and stuff when he found out what happened (<a href="https://www.youtube.com/watch?v=6ZrdPMU-Ofw">video</a>).</p>

<p>Looks like he was hacked. Here’s the VM Download you’ll use:</p>

<p><a href="https://files.utahcon.org/file/neverlan/NeverLAN%20CTF%2064-bit%2018.04.1.7z">https://files.utahcon.org/file/neverlan/NeverLAN%20CTF%2064-bit%2018.04.1.7z</a></p>

<p>7z md5 hash:  <code class="highlighter-rouge">cfb95b3d837602f1932fa309aafd8aff</code></p>

<p>Password to uncompress:  <code class="highlighter-rouge">the_path_to_the_dark_side</code></p>

<p>User’s Password:  <code class="highlighter-rouge">ikilledmydad</code></p>

<p>Challenge:</p>

<p>After a quick gander, we realized the user installed VNC with a crappy password. Can you get the password he used so we can prove to him it was bad?</p>

<p>Note: The password is the flag, it is not in the flag{} format.</p>

<h3 id="resolution"><em>RESOLUTION:</em></h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git clone https://github.com/jeroennijhof/vncpwd.git
Cloning into <span class="s1">'vncpwd'</span>...
remote: Enumerating objects: 28, <span class="k">done</span><span class="nb">.</span>
remote: Total 28 <span class="o">(</span>delta 0<span class="o">)</span>, reused 0 <span class="o">(</span>delta 0<span class="o">)</span>, pack-reused 28
Unpacking objects: 100% <span class="o">(</span>28/28<span class="o">)</span>, <span class="k">done</span><span class="nb">.</span>
<span class="nv">$ </span><span class="nb">cd </span>vncpwd/
<span class="nv">$ </span>gcc <span class="nt">-o</span> vncpwd vncpwd.c d3des.c
<span class="nv">$ </span>scp kyloren@192.168.1.7:~/.vnc/passwd ./
kyloren@192.168.1.7<span class="s1">'s password: 
passwd                                                                                                             100%    8     1.7KB/s   00:00    
$ ./vncpwd passwd 
Password: darthvad

</span></code></pre></div></div>
<p>FLAG: <strong>darthvad</strong></p>

<hr />

<h2 id="title-return-of-the-sith---part-2">Title: Return of the Sith - Part 2</h2>

<h3 id="points-100-1">Points: 100</h3>

<p>We’ve been given a specific forensics case by a really grumpy customer. He starting smashing consoles and stuff when he found out what happened (<a href="https://www.youtube.com/watch?v=6ZrdPMU-Ofw">video</a>).</p>

<p>Looks like he was hacked. Use the VM provided in Part 1.</p>

<p>Challenge:</p>

<p>Since they got in with VNC, they were locked into his user account, without any root access.  <em>The user used SUDO for ‘protection’ so that means he’s safe from the attacker getting his password, right?</em>  The goal here is to figure out if the user was able to escalate to root without having the user’s password. DO BE CAREFUL since messing with a VM has the ability to remove traces of what you’re looking for. This IS a forensics challenge.</p>

<p><em>Edit</em>: the point value was posted wrong. Droping it to 100 like it should have been.</p>

<h3 id="resolution-1"><em>RESOLUTION:</em></h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">history</span> | <span class="nb">grep sudo</span>
...
vim .xd/sudo 
<span class="nb">cat</span> .xd/sudo 
...
</code></pre></div></div>

<p>RUN:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vim .xd/sudo
</code></pre></div></div>

<p><img src="https://i.imgur.com/ISxr9xi.png" alt="" /></p>

<p><strong>**flag{check-out-my-sudo-stealer}</strong>**</p>

<hr />

<h2 id="title-return-of-the-sith---part-3">Title: Return of the Sith - Part 3</h2>

<h3 id="points-100-2">Points: 100</h3>

<p>We’ve been given a specific forensics case by a really grumpy customer. He starting smashing consoles and stuff when he found out what happened (<a href="https://www.youtube.com/watch?v=6ZrdPMU-Ofw">video</a>).</p>

<p>Looks like he was hacked. Use the VM provided in Part 1.</p>

<p>Challenge:</p>

<p>Ok, great. They had full root access, did they leave anything else behind? Any other backdoor?</p>

<p>Notes: This one is also not in the flag format, but the flag will be the ‘identifer’ of the back door. If you think you’ve found it, but it’s not accepting your challenge, you can message bashNinja on the  <a href="https://neverlanctfpublic.slack.com/join/shared_invite/enQtNTQwMDQzMTM5OTkwLWE4NThlODNkNTdjNGFhODkyZTdlYzliOGI4MzBiZDFkMDJlNjg3MjdkNDQ2MTRmOGM3NzVmZDE3ZTFhNjAzMzU">NeverLAN Slack</a>  and he will verify if you’ve gotten it correct or not.</p>

<h3 id="resolution-2"><em>RESOLUTION:</em></h3>

<p>User with superuser powers and mysql application not installed in the machine.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">history</span> | <span class="nb">grep </span>mysql

...
/usr/bin/sudo usermod <span class="nt">-a</span> <span class="nt">-G</span> <span class="nb">sudo </span>mysql
/usr/bin/sudo passwd mysql
...
</code></pre></div></div>
<p>FLAG: <strong>mysql</strong></p>

</div>

      </div>
  </div>
  <div class="py-3">
  <div class="container">
    <div class="row">
      <div class="col-md-12 text-center">
        <p class="mb-0 suffletext">© 2019-2020 Anderson Gomes</p>
      </div>
    </div>
  </div>
</div>
<script src="/assets/js/main.js"></script>
</body>
</html>
